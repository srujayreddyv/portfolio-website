<svg width="2200" height="1300" viewBox="0 0 2200 1300" fill="none" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="bgGrad" x1="0" y1="0" x2="2200" y2="1300" gradientUnits="userSpaceOnUse">
      <stop stop-color="#F8FAFF"/>
      <stop offset="1" stop-color="#EEF4FF"/>
    </linearGradient>
    <linearGradient id="frontendGrad" x1="0" y1="0" x2="1" y2="1">
      <stop stop-color="#DDF0FF"/>
      <stop offset="1" stop-color="#CDE2FF"/>
    </linearGradient>
    <linearGradient id="backendGrad" x1="0" y1="0" x2="1" y2="1">
      <stop stop-color="#DDFBE9"/>
      <stop offset="1" stop-color="#C9F4DD"/>
    </linearGradient>
    <linearGradient id="supabaseGrad" x1="0" y1="0" x2="1" y2="1">
      <stop stop-color="#F2E4FF"/>
      <stop offset="1" stop-color="#E5D0FF"/>
    </linearGradient>
    <linearGradient id="nodeBlue" x1="0" y1="0" x2="1" y2="1">
      <stop stop-color="#4E8DFF"/>
      <stop offset="1" stop-color="#356DE0"/>
    </linearGradient>
    <linearGradient id="nodeGreen" x1="0" y1="0" x2="1" y2="1">
      <stop stop-color="#45C777"/>
      <stop offset="1" stop-color="#2EA660"/>
    </linearGradient>
    <linearGradient id="nodePurple" x1="0" y1="0" x2="1" y2="1">
      <stop stop-color="#B06BFF"/>
      <stop offset="1" stop-color="#8A4CE0"/>
    </linearGradient>
    <linearGradient id="nodeCoral" x1="0" y1="0" x2="1" y2="1">
      <stop stop-color="#FF8F72"/>
      <stop offset="1" stop-color="#EB6D4C"/>
    </linearGradient>
    <linearGradient id="nodeSlate" x1="0" y1="0" x2="1" y2="1">
      <stop stop-color="#78879E"/>
      <stop offset="1" stop-color="#5D6D86"/>
    </linearGradient>
    <filter id="softShadow" x="-20%" y="-20%" width="140%" height="160%">
      <feOffset dy="10"/>
      <feGaussianBlur stdDeviation="10"/>
      <feColorMatrix type="matrix" values="0 0 0 0 0.19 0 0 0 0 0.31 0 0 0 0 0.51 0 0 0 0.18 0"/>
      <feBlend mode="normal" in2="SourceGraphic" result="shape"/>
    </filter>
    <filter id="cardShadow" x="-20%" y="-20%" width="140%" height="160%">
      <feOffset dy="6"/>
      <feGaussianBlur stdDeviation="6"/>
      <feColorMatrix type="matrix" values="0 0 0 0 0.15 0 0 0 0 0.23 0 0 0 0 0.37 0 0 0 0.18 0"/>
      <feBlend mode="normal" in2="SourceGraphic" result="shape"/>
    </filter>
    <marker id="arrowBlue" markerWidth="14" markerHeight="14" refX="10" refY="7" orient="auto">
      <path d="M0 0L12 7L0 14V0Z" fill="#366EDC"/>
    </marker>
    <marker id="arrowGreen" markerWidth="14" markerHeight="14" refX="10" refY="7" orient="auto">
      <path d="M0 0L12 7L0 14V0Z" fill="#2EA660"/>
    </marker>
    <marker id="arrowPurple" markerWidth="14" markerHeight="14" refX="10" refY="7" orient="auto">
      <path d="M0 0L12 7L0 14V0Z" fill="#8A4CE0"/>
    </marker>
    <style>
      .title { font: 700 52px "Inter", "Segoe UI", Arial, sans-serif; fill: #1B2A45; }
      .subtitle { font: 500 22px "Inter", "Segoe UI", Arial, sans-serif; fill: #3B4D6B; }
      .zone { font: 700 30px "Inter", "Segoe UI", Arial, sans-serif; fill: #20304D; }
      .nodeTitle { font: 700 24px "Inter", "Segoe UI", Arial, sans-serif; fill: #FFFFFF; }
      .nodeBody { font: 500 20px "Inter", "Segoe UI", Arial, sans-serif; fill: #F5F9FF; }
      .arrowLabel { font: 600 18px "Inter", "Segoe UI", Arial, sans-serif; fill: #304669; }
      .chip { font: 600 16px "Inter", "Segoe UI", Arial, sans-serif; fill: #506A93; }
    </style>
  </defs>

  <rect width="2200" height="1300" rx="28" fill="url(#bgGrad)"/>

  <text x="90" y="95" class="title">Buddhira Architecture</text>
  <text x="90" y="132" class="subtitle">Next.js frontend + FastAPI backend + Supabase Auth/Postgres + GitHub Actions release gates</text>

  <!-- Zone containers -->
  <rect x="70" y="180" width="660" height="1020" rx="28" fill="url(#frontendGrad)" stroke="#A8C7FF" stroke-width="3"/>
  <text x="105" y="240" class="zone">Frontend (Next.js 16)</text>

  <rect x="770" y="180" width="700" height="1020" rx="28" fill="url(#backendGrad)" stroke="#97E0B8" stroke-width="3"/>
  <text x="805" y="240" class="zone">Backend (FastAPI)</text>

  <rect x="1510" y="180" width="620" height="1020" rx="28" fill="url(#supabaseGrad)" stroke="#CAA6FF" stroke-width="3"/>
  <text x="1545" y="240" class="zone">Supabase</text>

  <!-- User node -->
  <rect x="110" y="285" width="290" height="120" rx="20" fill="url(#nodeSlate)" filter="url(#cardShadow)"/>
  <text x="140" y="335" class="nodeTitle">User Browser</text>
  <text x="140" y="370" class="nodeBody">Web + Mobile Viewports</text>

  <!-- Frontend nodes -->
  <rect x="110" y="470" width="580" height="180" rx="22" fill="url(#nodeBlue)" filter="url(#cardShadow)"/>
  <text x="145" y="530" class="nodeTitle">App Router Pages</text>
  <text x="145" y="568" class="nodeBody">/inbox, /new, /item/[id], /tags, /auth pages</text>
  <text x="145" y="602" class="nodeBody">Skeleton loaders, mobile filters, accessibility updates</text>

  <rect x="110" y="700" width="580" height="170" rx="22" fill="url(#nodeBlue)" filter="url(#cardShadow)"/>
  <text x="145" y="758" class="nodeTitle">apiFetch Wrapper</text>
  <text x="145" y="796" class="nodeBody">Bearer token attach, retry handling, 401 sign-out flow</text>
  <text x="145" y="830" class="nodeBody">Typed API contracts for items/tags/state</text>

  <rect x="110" y="920" width="580" height="180" rx="22" fill="url(#nodeBlue)" filter="url(#cardShadow)"/>
  <text x="145" y="980" class="nodeTitle">Supabase Auth Client</text>
  <text x="145" y="1018" class="nodeBody">signUp, signIn, reset password, callback exchange</text>
  <text x="145" y="1052" class="nodeBody">Session state + token lifecycle in browser</text>

  <!-- Backend nodes -->
  <rect x="810" y="320" width="620" height="170" rx="22" fill="url(#nodeGreen)" filter="url(#cardShadow)"/>
  <text x="845" y="378" class="nodeTitle">Middleware Layer</text>
  <text x="845" y="416" class="nodeBody">CORS, request logging, per-IP rate limiting</text>
  <text x="845" y="450" class="nodeBody">Health endpoint path exemptions</text>

  <rect x="810" y="535" width="620" height="170" rx="22" fill="url(#nodeGreen)" filter="url(#cardShadow)"/>
  <text x="845" y="593" class="nodeTitle">JWT Verification (JWKS)</text>
  <text x="845" y="631" class="nodeBody">ES256 signature validation + user extraction</text>
  <text x="845" y="665" class="nodeBody">No backend login/signup endpoints</text>

  <rect x="810" y="750" width="620" height="190" rx="22" fill="url(#nodeGreen)" filter="url(#cardShadow)"/>
  <text x="845" y="810" class="nodeTitle">Business Routes</text>
  <text x="845" y="848" class="nodeBody">/api/items, /api/tags, /api/items/{id}/tags, /me, /health</text>
  <text x="845" y="882" class="nodeBody">Search/filter, pin/archive/state, tag attachment logic</text>
  <text x="845" y="916" class="nodeBody">All data scoped by user_id</text>

  <rect x="810" y="980" width="620" height="130" rx="22" fill="url(#nodeGreen)" filter="url(#cardShadow)"/>
  <text x="845" y="1038" class="nodeTitle">Error Contract</text>
  <text x="845" y="1074" class="nodeBody">Consistent API errors: { detail, code }</text>

  <!-- Supabase nodes -->
  <rect x="1550" y="360" width="540" height="190" rx="22" fill="url(#nodePurple)" filter="url(#cardShadow)"/>
  <text x="1585" y="422" class="nodeTitle">Supabase Auth</text>
  <text x="1585" y="460" class="nodeBody">Email/password auth + recovery flows</text>
  <text x="1585" y="494" class="nodeBody">JWT issuer + JWKS endpoint</text>
  <text x="1585" y="528" class="nodeBody">Session / token lifecycle</text>

  <rect x="1550" y="640" width="540" height="260" rx="22" fill="url(#nodeCoral)" filter="url(#cardShadow)"/>
  <text x="1585" y="702" class="nodeTitle">Postgres + RLS</text>
  <text x="1585" y="740" class="nodeBody">Tables: items, tags, item_tags</text>
  <text x="1585" y="774" class="nodeBody">RLS policies enforce owner access</text>
  <text x="1585" y="808" class="nodeBody">Indexes for list/search performance</text>
  <text x="1585" y="842" class="nodeBody">Read/write via backend service-role client</text>
  <text x="1585" y="876" class="nodeBody">No direct frontend data writes</text>

  <rect x="1550" y="950" width="540" height="160" rx="22" fill="url(#nodePurple)" filter="url(#cardShadow)"/>
  <text x="1585" y="1012" class="nodeTitle">CI / Release Gates</text>
  <text x="1585" y="1050" class="nodeBody">Frontend lint + build + backend smoke test</text>
  <text x="1585" y="1084" class="nodeBody">GitHub Actions workflow</text>

  <!-- Arrows -->
  <path d="M400 345 C460 345, 460 520, 520 520" stroke="#366EDC" stroke-width="4" marker-end="url(#arrowBlue)"/>
  <text x="445" y="425" class="arrowLabel">UI interactions</text>

  <path d="M520 650 C700 650, 700 400, 810 400" stroke="#2EA660" stroke-width="4" marker-end="url(#arrowGreen)"/>
  <text x="645" y="620" class="arrowLabel">HTTP API calls</text>

  <path d="M520 790 C700 790, 700 610, 810 610" stroke="#2EA660" stroke-width="4" marker-end="url(#arrowGreen)"/>
  <text x="620" y="760" class="arrowLabel">Authorization: Bearer JWT</text>

  <path d="M690 1010 C960 1010, 960 455, 1550 455" stroke="#8A4CE0" stroke-width="4" marker-end="url(#arrowPurple)"/>
  <text x="1025" y="980" class="arrowLabel">Auth SDK operations</text>

  <path d="M1430 620 C1500 620, 1500 510, 1550 510" stroke="#8A4CE0" stroke-width="4" marker-end="url(#arrowPurple)"/>
  <text x="1465" y="560" class="arrowLabel">JWKS/token verification context</text>

  <path d="M1430 845 C1490 845, 1490 760, 1550 760" stroke="#2EA660" stroke-width="4" marker-end="url(#arrowGreen)"/>
  <text x="1448" y="800" class="arrowLabel">CRUD + filtered queries</text>

  <path d="M1120 320 C1290 260, 1700 260, 1820 360" stroke="#8A4CE0" stroke-width="3.5" stroke-dasharray="12 10" marker-end="url(#arrowPurple)"/>
  <text x="1305" y="248" class="chip">JWT trust chain via JWKS</text>

  <path d="M1120 1110 C1290 1170, 1700 1170, 1820 1110" stroke="#366EDC" stroke-width="3.5" stroke-dasharray="12 10" marker-end="url(#arrowBlue)"/>
  <text x="1240" y="1210" class="chip">Quality gate before deployment</text>
</svg>

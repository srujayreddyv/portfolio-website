<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1600 900" role="img" aria-label="CA DMV RAG System Architecture (Dark)">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0b1220"/>
      <stop offset="100%" stop-color="#111827"/>
    </linearGradient>
    <marker id="arrow" markerWidth="10" markerHeight="8" refX="9" refY="4" orient="auto">
      <path d="M0,0 L10,4 L0,8 Z" fill="#94a3b8"/>
    </marker>
    <style>
      .title { font: 700 38px Inter, Segoe UI, Arial, sans-serif; fill: #f8fafc; }
      .subtitle { font: 500 18px Inter, Segoe UI, Arial, sans-serif; fill: #cbd5e1; }
      .group { fill: #0f172a; stroke: #334155; stroke-width: 2; rx: 18; }
      .node { fill: #1e293b; stroke: #475569; stroke-width: 2; rx: 14; }
      .node-accent { fill: #172554; stroke: #3b82f6; }
      .label { font: 600 20px Inter, Segoe UI, Arial, sans-serif; fill: #e2e8f0; }
      .small { font: 500 16px Inter, Segoe UI, Arial, sans-serif; fill: #94a3b8; }
      .edge { stroke: #94a3b8; stroke-width: 3; fill: none; marker-end: url(#arrow); }
      .edge-soft { stroke: #64748b; stroke-width: 2.5; fill: none; marker-end: url(#arrow); }
    </style>
  </defs>

  <rect width="1600" height="900" fill="url(#bg)"/>

  <text x="70" y="75" class="title">CA DMV RAG System Architecture</text>
  <text x="70" y="108" class="subtitle">FastAPI + FAISS + Streamlit with reliability controls, CI, and production deployment</text>

  <rect x="60" y="160" width="1480" height="680" class="group"/>

  <!-- Left: User + UI -->
  <rect x="110" y="300" width="260" height="120" class="node"/>
  <text x="240" y="355" text-anchor="middle" class="label">End User</text>
  <text x="240" y="385" text-anchor="middle" class="small">Query + follow-up prompts</text>

  <rect x="420" y="260" width="320" height="200" class="node node-accent"/>
  <text x="580" y="325" text-anchor="middle" class="label">Streamlit App</text>
  <text x="580" y="355" text-anchor="middle" class="small">Streaming answers + citations</text>
  <text x="580" y="380" text-anchor="middle" class="small">Confidence-aware responses</text>

  <!-- Center: API + RAG -->
  <rect x="790" y="220" width="360" height="280" class="node"/>
  <text x="970" y="285" text-anchor="middle" class="label">FastAPI Service</text>
  <text x="970" y="315" text-anchor="middle" class="small">/ask, /ask/stream, /retrieve</text>
  <text x="970" y="340" text-anchor="middle" class="small">Request IDs + rate limiting</text>
  <text x="970" y="365" text-anchor="middle" class="small">Structured errors + metrics</text>

  <rect x="790" y="545" width="360" height="240" class="node"/>
  <text x="970" y="610" text-anchor="middle" class="label">RAG Retrieval Layer</text>
  <text x="970" y="640" text-anchor="middle" class="small">Chunk search + metadata filters</text>
  <text x="970" y="665" text-anchor="middle" class="small">Hybrid reranking + confidence gate</text>

  <!-- Right: Data + Model -->
  <rect x="1210" y="230" width="260" height="170" class="node"/>
  <text x="1340" y="290" text-anchor="middle" class="label">LLM Provider</text>
  <text x="1340" y="320" text-anchor="middle" class="small">Response generation</text>

  <rect x="1210" y="470" width="260" height="150" class="node"/>
  <text x="1340" y="525" text-anchor="middle" class="label">FAISS Index</text>
  <text x="1340" y="555" text-anchor="middle" class="small">Vector retrieval store</text>

  <rect x="1210" y="650" width="260" height="150" class="node"/>
  <text x="1340" y="705" text-anchor="middle" class="label">DMV Handbook</text>
  <text x="1340" y="735" text-anchor="middle" class="small">Source docs + chunks</text>

  <!-- Bottom: DevOps -->
  <rect x="130" y="610" width="610" height="180" class="node"/>
  <text x="435" y="670" text-anchor="middle" class="label">CI/CD + Testing</text>
  <text x="435" y="700" text-anchor="middle" class="small">GitHub Actions + PyTest suites</text>
  <text x="435" y="725" text-anchor="middle" class="small">API, retrieval, ingestion, evaluation checks</text>

  <rect x="130" y="200" width="250" height="70" class="node"/>
  <text x="255" y="245" text-anchor="middle" class="small">Streamlit Cloud + Render</text>

  <!-- Edges -->
  <path d="M370 360 L420 360" class="edge"/>
  <path d="M740 360 L790 360" class="edge"/>
  <path d="M970 500 L970 545" class="edge"/>
  <path d="M1150 310 L1210 310" class="edge"/>
  <path d="M1150 625 L1210 545" class="edge"/>
  <path d="M1340 620 L1340 650" class="edge-soft"/>
  <path d="M740 700 L790 700" class="edge-soft"/>
  <path d="M970 785 L970 815 L255 815 L255 270" class="edge-soft"/>
</svg>
